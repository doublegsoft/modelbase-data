<#import '/$/modelbase.ftl' as modelbase>

<#assign index = 0>
<#assign funid = statics["java.util.UUID"].randomUUID()?string?upper_case>
<#assign rootfunid = funid>
insert into tn_sam_fun (funid, parfunid, funnm, funtyp, ico, entpt, ordpos)
values ('${rootfunid}', null, '${description}', 'G', null, null, ${index});
<#list model.objects as obj>
  <#if !obj.isLabelled('entity') || obj.isLabelled('generated')><#continue></#if>

  <#assign index = index + 1>
  <#assign funid = statics["java.util.UUID"].randomUUID()?string?upper_case>
insert into tn_sam_fun (funid, parfunid, funnm, funtyp, ico, entpt, ordpos)
values ('${funid}', '${rootfunid}', '${modelbase.get_object_label(obj)}', 'E', null, 'html/stdbiz/${app.name}/${obj.name}/main.html', ${index});
  <#assign parfunid = funid>
  <#assign funid = statics["java.util.UUID"].randomUUID()?string?upper_case>
insert into tn_sam_fun (funid, parfunid, funnm, funtyp, ico, entpt, ordpos)
values ('${funid}', '${parfunid}', '修改', 'T', null, null, 0);
  <#assign funid = statics["java.util.UUID"].randomUUID()?string?upper_case>
insert into tn_sam_fun (funid, parfunid, funnm, funtyp, ico, entpt, ordpos)
values ('${funid}', '${parfunid}', '删除', 'T', null, null, 0);
  <#assign funid = statics["java.util.UUID"].randomUUID()?string?upper_case>
insert into tn_sam_fun (funid, parfunid, funnm, funtyp, ico, entpt, ordpos)
values ('${funid}', '${parfunid}', '查看', 'T', null, null, 0);
</#list>

<#assign index = 0>
<#list model.objects as obj>
  <#if !obj.isLabelled('entity') || obj.isLabelled('generated')><#continue></#if>
  <#assign index = index + 1>
  <#assign attrId = modelbase.get_id_attributes(obj)[0]>
  <#assign entyid = statics["java.util.UUID"].randomUUID()?string?upper_case>

insert into tn_sam_mngdenty (mngdentyid, mngdentynm, mngdentytyp, selsql, sts, sta)
values ('${obj.name?upper_case}', '${modelbase.get_object_label(obj)}', 'BIZ', 'select ${attrId.persistenceName} from ${obj.persistenceName}', '99', 'E');
  <#list obj.attributes as attr>

insert into tn_sam_mngdentyfld (mngdentyfldid, mngdentyid, mngdentyfldnm, mngdentyfldtyp, refid, reftyp, ordpos, sts, sta)
values ('${obj.name?upper_case}:${attr.name?upper_case}', '${obj.name?upper_case}', '${modelbase.get_attribute_label(attr)}', 'BIZ', '${obj.name?upper_case}:${attr.name?upper_case}', 'STDBIZ.DMM.COLUMN', ${attr?index + 1}, '99', 'E');
  </#list>
</#list>